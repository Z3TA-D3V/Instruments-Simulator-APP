
<h2 class="text-2xl text-white font-bold p-2">Altimeter</h2>
<section class="altimeter-box" [style.width]="altimeterConfig().altimeterWidth + 'px'" [style.height]="altimeterConfig().altimeterHeight + 'px'">
    <div class="clock" >
        <div class="clock-face" [style.width]="altimeterConfig().clockWidth + 'px'" [style.height]="altimeterConfig().clockHeight + 'px'">
            @for(coordinate of coordinates(); track coordinate.number) {
                <div class="number" 
                    [style.transform]="'translate(' + coordinate.x + 'px, ' + coordinate.y + 'px) translate(-50%, -50%)'">
                    {{coordinate.number}}
                </div>
                

                <!-- TODO: Ahora mismo hay 50 elementos por array, esta pintando todos cada vez que pinta un numero, hay que agrupar solo 5 grados, -->
                @for(gap of coordinate.coordinatesGaps; track gap.degree; let index = $index){
                    @if(index % altimeterConfig().altimeterGapAmount == 0){
                        <div class="number-gap big" [style.transform]="'translate(-50%, -50%) translate(' + gap.x + 'px, ' + gap.y + 'px) rotate(' + gap.degree + 'deg)'"></div>
                    }@else{
                        <div class="number-gap" [style.transform]="'translate(-50%, -50%) translate(' + gap.x + 'px, ' + gap.y + 'px) rotate(' + gap.degree + 'deg)'"></div>
                    }
                }
            }



            <div class="clock-hand" [style.transform]="'translate(-50%, -50%) rotate(' + currentAltitudeInfo().degrees + 'deg)'">
                <div class="clock-tip"></div>
                <div class="clock-body">
                    <div class="clock-center"></div>
                </div>
            </div>
        </div>

        <div class="clock-pneu" [ngClass]="{'elect-active': pneuModeSelected() === pneuModes.electric, 'pneu-active': pneuModeSelected() === pneuModes.pneumatic}">
            <div class="pneu-window" >
                <p class="pneu-text">{{ pneuModeSelected() }}</p>
            </div>
        </div>

        <div class="clock-altitude">
            <div class="altitude-window">
                <p class="altitude-text">{{ currentAltitudeInfo().fixedAltitude }}</p>
            </div>
            <div class="clock-altitude-label">
                <p class="clock-altitude-label-text ml-4">{{ literals().altitudex1000ft }}</p>
            </div>
        </div>

        
        <div class="clock-calibration-altitude">
            <div class="altitude-calibration-label">
                <p class="altitude-calibration-label-text">{{ literals().calibrationAltitude }}</p>
            </div>
            <div class="altitude-calibration-window">
                <p class="altitude-calibration-text">{{ altitudeCalibration() }}</p>
            </div>
        </div>
    </div>
</section>

<section class="flex gap-2 pt-8">
    <button (click)="onTestClick()" class="text-2xl text-black bg-green-300 hover:bg-green-600 px-4 py-4 rounded-md">Probar Altímetro</button>
    <button (click)="onStopClick()" class="text-2xl text-black bg-red-300 hover:bg-red-600 px-4 py-4 rounded-md">Parar Altímetro</button>
    <button (click)="onChangePneumaticMode()" class="text-2xl text-black bg-amber-300 hover:bg-amber-600 px-4 py-4 rounded-md">Cambiar Modo</button>
</section>

<p class="pt-3">Altitud actual: {{ currentAltitudeInfo().realAltitude }} ft | Degrees: {{ currentAltitudeInfo().degrees }}</p>

